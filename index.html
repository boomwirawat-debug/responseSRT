<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>โปรแกรมสร้างข้อความประกาศสถานการณ์เดินรถ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            scroll-behavior: smooth;
            background-color: #f1f5f9; /* bg-slate-100 */
        }
        /* Custom focus ring */
        input:focus, select:focus, textarea:focus {
            box-shadow: 0 0 0 2px #3b82f6; /* ring-2 ring-blue-500 */
            border-color: #3b82f6;
            outline: none;
        }
        /* Simple transition for hidden elements */
        .hidden {
            display: none;
        }
    </style>
</head>
<body class="p-4 sm:p-6 lg:p-8">
    <div class="max-w-7xl mx-auto">
        <header class="mb-8">
            <div class="flex items-center gap-4">
                 <div class="bg-indigo-600 p-3 rounded-xl text-white shadow-md">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-train-front"><path d="M8 3.1c.9 1.4 1.5 3.5 1.5 5.9"/><path d="M14.5 9c0-2.4.6-4.5 1.5-5.9"/><path d="M5 9h14v10H5z"/><path d="M5 19a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2"/><path d="M8 13h8"/><path d="m8 9-1-1"/><path d="m16 9 1-1"/></svg>
                 </div>
                <div>
                    <h1 class="text-2xl sm:text-3xl font-bold text-slate-800">โปรแกรมสร้างประกาศ</h1>
                    <p class="text-slate-500 mt-1">กรอกข้อมูลเพื่อสร้างประกาศสถานการณ์เดินรถ</p>
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-5 gap-8 items-start">
            
            <!-- Left Column: Form Sections -->
            <form id="announcementForm" class="lg:col-span-3 space-y-8">

                <!-- Section 1: Train Information -->
                <section class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 sm:p-8">
                    <h2 class="text-xl font-bold text-slate-800 flex items-center gap-3 mb-6">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-indigo-500 lucide lucide-train-track"><path d="M2 17 17 2"/><path d="m2 14 8 8"/><path d="m5 11 8 8"/><path d="m8 8 8 8"/><path d="m11 5 8 8"/><path d="M7 22 22 7"/></svg>
                        <span>1. ข้อมูลขบวนรถ</span>
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="trainType" class="block text-sm font-medium text-slate-600 mb-2">ประเภทขบวนรถ</label>
                            <select id="trainType" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition">
                                <option value="รถด่วนพิเศษ">รถด่วนพิเศษ</option>
                                <option value="รถด่วน">รถด่วน</option>
                                <option value="รถเร็ว">รถเร็ว</option>
                                <option value="รถธรรมดา">รถธรรมดา</option>
                                <option value="รถท้องถิ่น">รถท้องถิ่น</option>
                                <option value="รถชานเมือง">รถชานเมือง</option>
                            </select>
                        </div>
                        <div>
                            <label for="trainNumberInput" class="block text-sm font-medium text-slate-600 mb-2">หมายเลขขบวน</label>
                            <input type="text" id="trainNumberInput" list="trainNumbersList" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition" placeholder="พิมพ์เพื่อค้นหา...">
                            <datalist id="trainNumbersList"></datalist>
                        </div>
                        <div>
                            <label for="origin" class="block text-sm font-medium text-slate-600 mb-2">สถานีต้นทาง</label>
                            <input type="text" id="origin" list="stationList" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition" placeholder="พิมพ์ชื่อสถานี...">
                        </div>
                        <div>
                            <label for="destination" class="block text-sm font-medium text-slate-600 mb-2">สถานีปลายทาง</label>
                            <input type="text" id="destination" list="stationList" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition" placeholder="พิมพ์ชื่อสถานี...">
                            <datalist id="stationList"></datalist>
                        </div>
                    </div>
                </section>

                <!-- Section 2: Incident Details -->
                <section class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 sm:p-8">
                    <h2 class="text-xl font-bold text-slate-800 flex items-center gap-3 mb-6">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-indigo-500 lucide lucide-shield-alert"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="M12 8v4"/><path d="M12 16h.01"/></svg>
                        <span>2. รายละเอียดเหตุการณ์</span>
                    </h2>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="md:col-span-2">
                            <label for="reason" class="block text-sm font-medium text-slate-600 mb-2">สาเหตุ</label>
                            <select id="reason" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition">
                                <option value="1">1. รถจักรขัดข้อง</option>
                                <option value="2">2. ตู้โดยสารขัดข้อง</option>
                                <option value="3">3. ขบวนรถทำความเร็วไม่ได้</option>
                                <option value="4">4. ขบวนรถขัดข้อง</option>
                                <option value="5">5. เครื่องปรับอากาศชำรุด</option>
                                <option value="6">6. ออกจากต้นทางล่าช้า</option>
                                <option value="7">7. รอรถหมุนเวียน</option>
                                <option value="8">8. ชนยานพาหนะ</option>
                                <option value="9">9. ชนสัตว์</option>
                                <option value="10">10. อุบัติเหตุเกี่ยวกับบุคคล</option>
                                <option value="11">11. ดินสไลด์</option>
                                <option value="12">12. น้ำท่วม</option>
                                <option value="13">13. รอเปิดทาง</option>
                                <option value="14">14. มีสิ่งกีดขวางในทาง</option>
                                <option value="15">15. ระบบอาณัติสัญญาณขัดข้อง</option>
                                <option value="16">16. ขบวนรถตกราง</option>
                                <option value="17">17. รอเคลียร์เส้นทาง</option>
                                <option value="18">18. ปรับเปลี่ยนตู้โดยสาร</option>
                                <option value="19">19. ไม่มีตู้ให้บริการ</option>
                            </select>
                        </div>
                        <div id="carriageNumberWrapper" class="hidden">
                            <label for="carriageNumber" class="block text-sm font-medium text-slate-600 mb-2">หมายเลขตู้โดยสาร</label>
                            <input type="text" id="carriageNumber" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition" placeholder="เช่น คันที่ 3">
                        </div>
                         <div id="carriageChangeWrapper" class="hidden md:col-span-2">
                            <label for="carriageChangeType" class="block text-sm font-medium text-slate-600 mb-2">รายละเอียดการปรับเปลี่ยน</label>
                            <select id="carriageChangeType" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition">
                                <option value="fan_to_ac">เปลี่ยนจากรถพัดลมเป็นปรับอากาศ</option>
                                <option value="ac_to_fan">เปลี่ยนจากรถปรับอากาศเป็นรถพพัดลม</option>
                                <option value="class_upgrade">เปลี่ยนจากรถชั้น 3 เป็นรถชั้น 2</option>
                                <option value="fan_sleeper_to_ac_sleeper">เปลี่ยนจากรถนอนพัดลมเป็นรถนอนปรับอากาศ</option>
                                <option value="ac_sleeper_to_fan_sleeper">เปลี่ยนจากรถนอนปรับอากาศเป็นรถนอนพัดลม</option>
                            </select>
                        </div>
                         <div id="unavailableCarriageWrapper" class="hidden grid grid-cols-1 sm:grid-cols-2 gap-4 md:col-span-2">
                            <div>
                                <label for="unavailableDate" class="block text-sm font-medium text-slate-600 mb-2">วันที่</label>
                                <input type="date" id="unavailableDate" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition">
                            </div>
                            <div>
                                <label for="unavailableCarriageType" class="block text-sm font-medium text-slate-600 mb-2">ประเภทตู้โดยสาร</label>
                                <select id="unavailableCarriageType" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition">
                                    <option value="ตู้นอนปรับอากาศ ชั้น1">ตู้นอนปรับอากาศ ชั้น1</option>
                                    <option value="ตู้นอนปรับอากาศ ชั้น2">ตู้นอนปรับอากาศ ชั้น2</option>
                                    <option value="ตู้นอนพัดลมชั้น2">ตู้นอนพัดลมชั้น2</option>
                                    <option value="ตู้โดยสาร ชั้น2">ตู้โดยสาร ชั้น2</option>
                                    <option value="ตู้โดยสาร ชั้น3">ตู้โดยสาร ชั้น3</option>
                                    <option value="ตู้เสบียง">ตู้เสบียง</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label for="locationType" class="block text-sm font-medium text-slate-600 mb-2">ประเภทสถานที่เกิดเหตุ</label>
                            <select id="locationType" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition">
                                <option value="at_station">ที่สถานี</option>
                                <option value="between_stations">ระหว่างสถานี</option>
                                <option value="not_specified" selected>ไม่ระบุ</option>
                            </select>
                        </div>
                        <div id="locationAtStationWrapper" class="hidden">
                            <label for="locationStation" class="block text-sm font-medium text-slate-600 mb-2">ชื่อสถานี</label>
                            <input type="text" id="locationStation" list="stationList" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition" placeholder="เช่น ชะอวด">
                        </div>
                        <div id="locationBetweenWrapper" class="hidden grid grid-cols-2 gap-4 md:col-span-2">
                            <div>
                                <label for="locationBetween1" class="block text-sm font-medium text-slate-600 mb-2">จากสถานี</label>
                                <input type="text" id="locationBetween1" list="stationList" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition" placeholder="เช่น ชะอวด">
                            </div>
                            <div>
                                <label for="locationBetween2" class="block text-sm font-medium text-slate-600 mb-2">ถึงสถานี</label>
                                <input type="text" id="locationBetween2" list="stationList" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition" placeholder="เช่น บ้านตูล">
                            </div>
                        </div>
                        <div class="md:col-span-2">
                            <label for="actionTaken" class="block text-sm font-medium text-slate-600 mb-2">การดำเนินการแก้ไข</label>
                            <select id="actionTaken" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition">
                                <option value="">-- ไม่ระบุ --</option>
                                <option value="fixing">เจ้าหน้าที่กำลังดำเนินการแก้ไข</option>
                                <option value="waiting_rescue">กำลังรอรถจักรมาทำการช่วยเหลือ</option>
                                <option value="waiting_inspection">รอเจ้าหน้าที่เข้าตรวจสอบ</option>
                                <option value="clearing">กำลังเคลียร์พื้นที่</option>
                            </select>
                        </div>
                    </div>
                </section>

                <!-- Section 3: Passenger Information -->
                 <section class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 sm:p-8">
                     <h2 class="text-xl font-bold text-slate-800 flex items-center gap-3 mb-6">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-indigo-500 lucide lucide-users"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                        <span>3. ข้อมูลสำหรับผู้โดยสาร</span>
                    </h2>
                    <div class="grid grid-cols-1 gap-6">
                         <div>
                            <label for="delayTime" class="block text-sm font-medium text-slate-600 mb-2">เวลาที่คาดว่าจะล่าช้า (ถ้ามี)</label>
                            <input type="text" id="delayTime" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition" placeholder="เช่น 30 นาที">
                        </div>
                        <div class="col-span-full">
                            <label for="instruction" class="block text-sm font-medium text-slate-600 mb-2">คำแนะนำผู้โดยสาร</label>
                            <select id="instruction" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition">
                                <option value="none">ไม่มี</option>
                                <option value="wait">โปรดรอการประกาศครั้งต่อไป</option>
                                <option value="alternative">กำลังจัดเตรียมการขนส่งทางเลือก</option>
                                <option value="refund">ผู้โดยสารสามารถติดต่อขอรับคืนเงินค่าตั๋วโดยสารได้ที่สถานีรถไฟทั่วประเทศ</option>
                                <option value="disembark">ผู้โดยสารที่ต้องการสละสิทธิ์ สามารถลงจากขบวนรถได้</option>
                                <option value="upgrade_pets">แนะนำกรณีปรับเปลี่ยนตู้โดยสาร/สัตว์เลี้ยง</option>
                            </select>
                        </div>
                        <div class="col-span-full">
                            <label for="notes" class="block text-sm font-medium text-slate-600 mb-2">บันทึกเพิ่มเติม (ระบบจะแปลเฉพาะบางวลี)</label>
                            <textarea id="notes" rows="2" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg transition" placeholder="ระบุข้อมูลอื่นๆ เพิ่มเติม..."></textarea>
                        </div>
                        <div class="col-span-full">
                            <label class="flex items-center space-x-3 bg-slate-50 border border-slate-300 rounded-lg p-3 cursor-pointer hover:bg-slate-100 transition-colors">
                                <input id="otherTrainsAffected" type="checkbox" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                                <span class="text-sm font-medium text-slate-700">เหตุการณ์นี้อาจส่งผลกระทบต่อขบวนรถอื่น</span>
                            </label>
                        </div>
                    </div>
                </section>

                <!-- Action Buttons -->
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <button type="submit" class="w-full flex items-center justify-center gap-2 bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all duration-300">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-signature"><path d="M20 19.5v.5a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8.5L20 7.5V10"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="m14.2 15.8 3.4 3.4 5.8-5.8"/><path d="M13 18.5a.5.5 0 0 0-1 0V20a1 1 0 0 0 1 1h1.5a.5.5 0 0 0 0-1H14v-1.5a.5.5 0 0 0-.5-.5Z"/></svg>
                        สร้างข้อความประกาศ
                    </button>
                     <button type="button" id="clearFormBtn" class="w-full flex items-center justify-center gap-2 bg-slate-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 transition-all duration-300">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eraser"><path d="m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21H7Z"/><path d="M22 21H7"/><path d="m5 12 5 5"/></svg>
                        ล้างข้อมูล
                    </button>
                </div>
            </form>

            <!-- Right Column: Output Area -->
            <div id="outputArea" class="lg:col-span-2 self-start sticky top-8 hidden">
                <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 sm:p-8">
                    <h2 class="text-xl font-bold text-slate-800 flex items-center gap-3 mb-6">
                       <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-indigo-500 lucide lucide-volume-2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></svg>
                        <span>ผลลัพธ์ข้อความประกาศ</span>
                    </h2>
                    
                    <!-- Full Announcement -->
                    <div class="space-y-6">
                        <h3 class="text-base font-semibold text-slate-600">ข้อความประกาศ (แบบเต็ม)</h3>
                        <div class="bg-slate-50 p-4 rounded-lg border border-slate-200">
                            <div class="flex justify-between items-center mb-2">
                                <h4 class="text-sm font-semibold text-slate-700">ภาษาไทย</h4>
                                <button type="button" onclick="copyToClipboard('thaiOutput', this)" class="bg-white text-slate-500 px-3 py-1 rounded-md text-sm hover:bg-slate-100 hover:text-slate-700 border border-slate-300 transition-all flex items-center gap-1.5">
                                   <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
                                   <span>คัดลอก</span>
                                </button>
                            </div>
                            <p id="thaiOutput" class="text-slate-800 whitespace-pre-wrap text-sm leading-relaxed"></p>
                        </div>
                        <div class="bg-sky-50 p-4 rounded-lg border border-sky-200">
                            <div class="flex justify-between items-center mb-2">
                                <h4 class="text-sm font-semibold text-sky-800">English</h4>
                                <button type="button" onclick="copyToClipboard('englishOutput', this)" class="bg-white text-slate-500 px-3 py-1 rounded-md text-sm hover:bg-slate-100 hover:text-slate-700 border border-slate-300 transition-all flex items-center gap-1.5">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
                                    <span>Copy</span>
                                </button>
                            </div>
                            <p id="englishOutput" class="text-sky-900 whitespace-pre-wrap text-sm leading-relaxed font-mono"></p>
                        </div>
                    </div>

                    <!-- Ticker Announcement -->
                    <div class="space-y-6 mt-8 pt-6 border-t border-slate-200">
                        <h3 class="text-base font-semibold text-slate-600">ข้อความสำหรับตัวหนังสือวิ่ง (แบบสั้น)</h3>
                        <div class="bg-amber-50 p-4 rounded-lg border border-amber-200">
                            <div class="flex justify-between items-center mb-2">
                                <h4 class="text-sm font-semibold text-amber-800">ภาษาไทย</h4>
                                <button type="button" onclick="copyToClipboard('thaiTickerOutput', this)" class="bg-white text-slate-500 px-3 py-1 rounded-md text-sm hover:bg-slate-100 hover:text-slate-700 border border-slate-300 transition-all flex items-center gap-1.5">
                                   <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
                                   <span>คัดลอก</span>
                                </button>
                            </div>
                            <p id="thaiTickerOutput" class="text-amber-900 whitespace-pre-wrap font-semibold text-sm"></p>
                        </div>
                        <div class="bg-amber-50 p-4 rounded-lg border border-amber-200">
                            <div class="flex justify-between items-center mb-2">
                                <h4 class="text-sm font-semibold text-amber-800">English</h4>
                                <button type="button" onclick="copyToClipboard('englishTickerOutput', this)" class="bg-white text-slate-500 px-3 py-1 rounded-md text-sm hover:bg-slate-100 hover:text-slate-700 border border-slate-300 transition-all flex items-center gap-1.5">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
                                   <span>Copy</span>
                                </button>
                            </div>
                            <p id="englishTickerOutput" class="text-amber-900 whitespace-pre-wrap font-semibold text-sm font-mono"></p>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    
    <div id="toast" class="fixed bottom-5 right-5 bg-green-500 text-white py-2 px-4 rounded-lg shadow-lg opacity-0 transition-opacity duration-300 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check-circle-2"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="m9 12 2 2 4-4"/></svg>
        คัดลอกข้อความแล้ว!
    </div>

<script>
    // --- DATABASE & DICTIONARIES ---
    const trainTypeMap = { 'รถด่วนพิเศษ': 'Special Express', 'รถด่วน': 'Express', 'รถเร็ว': 'Rapid', 'รถธรรมดา': 'Ordinary', 'รถท้องถิ่น': 'Local', 'รถชานเมือง': 'Commuter' };
    const reasons = {
        '1': { thai: "รถจักรขัดข้อง", english: "a locomotive failure" },
        '2': { thai: "ตู้โดยสารขัดข้อง", english: "a carriage failure" },
        '3': { thai: "ไม่สามารถใช้ความเร็วสูงสุดได้", english: "unable to run at maximum speed" },
        '4': { thai: "ขบวนรถขัดข้อง", english: "a train malfunction" },
        '5': { thai: "เครื่องปรับอากาศชำรุด", english: "an air conditioning failure" },
        '6': { thai: "ออกจากต้นทางล่าช้า", english: "a delayed departure from its departure station" },
        '7': { thai: "รอรถหมุนเวียน", english: "waiting for connecting rolling stock" },
        '8': { thai: "ชนยานพาหนะ", english: "a collision with a vehicle" },
        '9': { thai: "ชนสัตว์", english: "a collision with an animal" },
        '10': { thai: "อุบัติเหตุเกี่ยวกับบุคคล", english: "an incident involving a person" },
        '11': { thai: "ดินสไลด์", english: "a landslide on the track" },
        '12': { thai: "น้ำท่วม", english: "flooding on the track" },
        '13': { thai: "รอเปิดทาง", english: "waiting for track clearance" },
        '14': { thai: "มีสิ่งกีดขวางในทาง", english: "an obstruction on the track" },
        '15': { thai: "ระบบอาณัติสัญญาณขัดข้อง", english: "a signaling system failure" },
        '16': { thai: "ขบวนรถตกราง", english: "a train derailment" },
        '17': { thai: "รอเคลียร์เส้นทาง", english: "waiting for the line to be cleared" },
        '18': { thai: "ปรับเปลี่ยนตู้โดยสาร", english: "a carriage change" },
        '19': { thai: "ไม่มีตู้ให้บริการ", english: "a carriage is unavailable" }
    };
    const actions = {
        thai: { "fixing": "ขณะนี้เจ้าหน้าที่กำลังดำเนินการแก้ไข", "waiting_rescue": "ขณะนี้กำลังรอรถจักรมาทำการช่วยเหลือ", "waiting_inspection": "ขณะนี้รอเจ้าหน้าที่เข้าตรวจสอบความปลอดภัย", "clearing": "ขณะนี้กำลังดำเนินการเคลียร์พื้นที่" },
        english: { "fixing": "Crews are currently working to resolve the issue.", "waiting_rescue": "A rescue locomotive is being arranged.", "waiting_inspection": "We are awaiting a safety inspection.", "clearing": "The area is currently being cleared." }
    };
    const instructions = {
        thai: { 'wait': "โปรดรอรับฟังการประกาศครั้งต่อไป", 'alternative': "กำลังจัดเตรียมการขนส่งทางเลือกสำหรับผู้โดยสาร", 'refund': "ผู้โดยสารสามารถติดต่อขอรับคืนเงินค่าตั๋วโดยสารได้ที่สถานีรถไฟทั่วประเทศ", 'disembark': "ผู้โดยสารที่มีความประสงค์จะสละสิทธิ์การเดินทาง สามารถลงจากขบวนรถได้", 'upgrade_pets': "สำหรับผู้โดยสารที่จองล่วงหน้า ไม่มีการเก็บค่าบริการเพิ่มเติม กรณีผู้โดยสารเดินทางพร้อมสัตว์เลี้ยงโปรดติดต่อเจ้าหน้าที่สถานี ก่อนขึ้นขบวนรถ" },
        english: { 'wait': "Please wait for further announcements.", 'alternative': "Alternative transportation is being arranged.", 'refund': "Passengers can request a ticket refund at any station nationwide.", 'disembark': "Passengers who wish to forfeit their journey may disembark.", 'upgrade_pets': "For passengers with advance bookings, no additional fees will be charged. Additionally, passengers traveling with pets are requested to contact station staff before boarding." }
    };
    const carriageChangeMap = {
        'fan_to_ac': { thai: "เปลี่ยนจากรถพัดลมเป็นปรับอากาศ", english: "changing from a fan car to an air-conditioned car" },
        'ac_to_fan': { thai: "เปลี่ยนจากรถปรับอากาศเป็นรถพัดลม", english: "changing from an air-conditioned car to a fan car" },
        'class_upgrade': { thai: "เปลี่ยนจากรถชั้น 3 เป็นรถชั้น 2", english: "upgrading from a 3rd class to a 2nd class car" },
        'fan_sleeper_to_ac_sleeper': { thai: "เปลี่ยนจากรถนอนพัดลมเป็นรถนอนปรับอากาศ", english: "changing from a fan sleeper to an air-conditioned sleeper" },
        'ac_sleeper_to_fan_sleeper': { thai: "เปลี่ยนจากรถนอนปรับอากาศเป็นรถนอนพัดลม", english: "changing from an air-conditioned sleeper to a fan sleeper" }
    };
    const unavailableCarriageMap = {
        "ตู้นอนปรับอากาศ ชั้น1": "1st Class Air-conditioned Sleeper", "ตู้นอนปรับอากาศ ชั้น2": "2nd Class Air-conditioned Sleeper",
        "ตู้นอนพัดลมชั้น2": "2nd Class Fan Sleeper", "ตู้โดยสาร ชั้น2": "2nd Class Coach", "ตู้โดยสาร ชั้น3": "3rd Class Coach", "ตู้เสบียง": "Dining Car"
    };
    // A comprehensive, sorted list of all SRT stations.
    const stationTranslation = {
        "กบินทร์เก่า": "Kabin Kao",
        "กบินทร์บุรี": "Kabin Buri",
        "กะแดะ": "Kadae",
        "กะปาง": "Kapang",
        "กันตัง": "Kantang",
        "กันทรารมย์": "Kanthararom",
        "กุยบุรี": "Kui Buri",
        "กุดจิก": "Kut Chik",
        "กุมภวาปี": "Kumphawapi",
        "เกาะแขบ": "Ko Saba",
        "เกาะมหามงคล": "Ko Maha Mongkhon",
        "เกาะสะบ้า": "Ko Saba",
        "แก่งคอย": "Kaeng Khoi Junction",
        "แก่งหลวง": "Kaeng Luang",
        "แก่งเสือเต้น": "Kaeng Suea Ten",
        "กรุงเทพ(หัวลำโพง)": "Bangkok (Hua Lamphong)",
        "กรุงเทพอภิวัฒน์": "Krung Thep Aphiwat Central Terminal",
        "กระสัง": "Krasang",
        "กระเบียด": "Krabiat",
        "กลอย": "Ban Kloi",
        "กลางดง": "Klang Dong",
        "กลับ": "Ban Klap",
        "กล้วย": "Ban Kluai",
        "กวาว": "Ban Kok Kwao",
        "กันตัง": "Kantang",
        "กาญจนบุรี": "Kanchanaburi",
        "กำแพงแสน": "Kamphaeng Saen",
        "กิเลน": "Tha Kilen",
        "กุยบุรี": "Kui Buri",
        "กุย": "Khlong Kui",
        "เกาะ": "Ban Ko",
        "เกาะรัง": "Ban Ko Rang",
        "เกาะใหญ่": "Ban Ko Yai",
        "เก่า": "Ban Kao",
        "แก้ง": "Ban Kaeng",
        "แกรนด์ คาแนล": "Grand Canal",
        "ไกร": "Ho Krai",
        "ขอนแก่น": "Khon Kaen",
        "ขอนหาด": "Ban Khon Hat",
        "ขบวนรถ": "Train",
        "ขวาง": "Huai Khwang",
        "ขวัญ": "Bang Khwan",
        "ขุนตาน": "Khun Tan",
        "ขุนวิเศษ": "Don Khun Wiset",
        "ไข่น้ำ": "Nong Khai Nam",
        "เขาชัยสน": "Khao Chaison",
        "เขาไชยราช": "Khao Chaiyarat",
        "เขาชุมทอง": "Khao Chum Thong Junction",
        "เขาเต่า": "Khao Tao",
        "เขาทะโมน": "Khao Thamon",
        "เขาทอง": "Khao Thong",
        "เขาพระบาท": "Khao Phra Bat",
        "เขาพลึง": "Khao Phlueng",
        "เขาพลู": "Khao Phlu",
        "เขาปีบ": "Khao Pip",
        "เขาปูน": "Khao Pun",
        "เขาย้อย": "Khao Yoi",
        "เขายายกะตา": "Khao Yai Ka Ta",
        "เขาหลง": "Khao Luang",
        "เขาสวนกวาง": "Khao Suan Kwang",
        "เขาสวนทุเรียน": "Khao Suan Thurian",
        "เขาสูง": "Khao Sung",
        "เขาหินดาด": "Khao Hin Dat",
        "เขตเมือง": "Khet Mueang",
        "แขวงกลั่น": "Khlong Khwaeng Klan",
        "ไข่น้ำ": "Nong Khai Nam",
        "คันธุลี": "Khanthuli",
        "คั่นกระได": "Khan Kradai",
        "คำกลิ้ง": "Kham Kling",
        "คีรีรัฐนิคม": "Khiri Rat Nikhom",
        "คลองแขวงกลั่น": "Khlong Khwaeng Klan",
        "คลองจันดี": "Khlong Chan Di",
        "คลองจัง": "Khlong Chang",
        "คลองจาก": "Khlong Chak",
        "คลองตัน": "Khlong Tan",
        "คลองตาคต": "Khlong Ta Khot",
        "คลองทราย": "Khlong Sai",
        "คลองบางตาล": "Khlong Bang Tan",
        "คลองบางพระ": "Khlong Bang Phra",
        "คลองปลากด": "Khlong Pla Kot",
        "คลองปราบ": "Khlong Prap",
        "คลองปู": "Wat Khlong Pu",
        "คลองพุทรา": "Khlong Phutsa",
        "คลองไผ่": "Khlong Phai",
        "คลองมหาสวัสดิ์": "Khlong Maha Sawat",
        "คลองมะพลับ": "Khlong Maphlap",
        "คลองมวน": "Khlong Muan",
        "คลองยา": "Khlong Ya",
        "คลองยาง": "Khlong Yang",
        "คลองยัน": "Khlong Yan",
        "คลองยี่สิบเอ็ด": "Khlong Yi Sip Et",
        "คลองรังสิต": "Khlong Rangsit",
        "คลองละมุง": "Khlong Lamung",
        "คลองหลวงแพ่ง": "Khlong Luang Phaeng",
        "คลองวังช้าง": "Khlong Wang Chang",
        "คลองสิบเก้า": "Khlong Sip Kao Junction",
        "คลองสูญ": "Khlong Sun",
        "คลองหนึ่ง": "Khlong Nueng",
        "คลองอุดมชลจร": "Khlong Udom Chonlachon",
        "คลองแงะ": "Khlong Ngae",
        "ควนเมา": "Khuan Mao",
        "ควนเนียง": "Khuan Niang",
        "ควนพระ": "Khuan Phra",
        "ควนหนองคว้า": "Khuan Nong Khwa",
        "ควนหินมุ้ย": "Khuan Hin Mui",
        "ควนเคี่ยม": "Khuan Khiam",
        "คอกควาย": "Khok Khwai",
        "คอกม้า": "Ban Khok Ma",
        "คอม": "Ban Pong Kom",
        "คอนแวนต์": "Assumption Convent School",
        "แค": "Tha Khae",
        "แควน้อย": "Khwae Noi",
        "โคกกระเทียม": "Khok Kathiam",
        "โคกกรวด": "Khok Kruat",
        "โคกคลี": "Khok Khli",
        "โคกคราม": "Khok Khram",
        "โคกตาหอม": "Khok Ta Hom",
        "โคกทราย": "Khok Sai",
        "โคกมะกอก": "Khok Makok",
        "โคกสลุง": "Khok Salung",
        "โคกสยา": "Khok Saya",
        "โคน": "Ban Khon",
        "งิ้ว": "Hua Ngiu",
        "งิ้วราย": "Wat Ngiu Rai",
        "จันเสน": "Chansen",
        "จันทึก": "Chanthuek",
        "จักราช": "Chakkarat",
        "จัตุรัส": "Chatturat",
        "จอมทอง": "Chom Thong",
        "จะนะ": "Chana",
        "จัง": "Khlong Chang",
        "จันดี": "Khlong Chan Di",
        "ฉะเชิงเทรา": "Chachoengsao Junction",
        "ฉวาง": "Chawang",
        "ฉิมพลี": "Ban Chimphli",
        "ฉัตร": "Hang Chat",
        "ชนบท": "Chonnabot",
        "ชลบุรี": "Chon Buri",
        "ช่องแค": "Chong Khae",
        "ช่องแคบ": "Chongkhaep",
        "ช่องเขา": "Chong Khao",
        "ช่องสำราญ": "Chong Samran",
        "ชะอำ": "Cha-am",
        "ชะอวด": "Cha-uat",
        "ชะมวง": "Chamuang",
        "ชัยบุรี": "Chai Buri",
        "ไชยา": "Chaiya",
        "ชีผ้าขาว": "Ban Chi Phakhao",
        "ชุมพร": "Chumphon",
        "ชุมแสง": "Chum Saeng",
        "ชุมทางเขาชุมทอง": "Khao Chum Thong Junction",
        "ชุมทางแก่งคอย": "Kaeng Khoi Junction",
        "ชุมทางฉะเชิงเทรา": "Chachoengsao Junction",
        "ชุมทางตลิ่งชัน": "Taling Chan Junction",
        "ชุมทางถนนจิระ": "Thanon Chira Junction",
        "ชุมทางทุ่งสง": "Thung Song Junction",
        "ชุมทางบ้านทุ่งโพธิ์": "Ban Thung Pho Junction",
        "ชุมทางบ้านภาชี": "Ban Phachi Junction",
        "ชุมทางบัวใหญ่": "Bua Yai Junction",
        "ชุมทางบางซื่อ": "Bang Sue Grand Station",
        "ชุมทางศรีราชา": "Si Racha Junction",
        "ชุมทางหนองปลาดุก": "Nong Pladuk Junction",
        "ชุมทางหาดใหญ่": "Hat Yai Junction",
        "เชียงราก": "Chiang Rak",
        "เชียงรากน้อย": "Chiang Rak Noi",
        "เชียงใหม่": "Chiang Mai",
        "แชร์": "Ban Phru Krachaeng",
        "ไชยราช": "Khao Chaiyarat",
        "ซับม่วง": "Sap Muang",
        "ซอยวัดลานบุญ": "Soi Wat Lan Bun",
        "ญาณสังวราราม": "Yanasangwararam",
        "ดอนขุนวิเศษ": "Don Khun Wiset",
        "ดอนจิก": "Don Chik",
        "ดอนทราย": "Don Sai",
        "ดอนทอง": "Don Thong",
        "ดอนนาง": "Don Ya Nang",
        "ดอนมูล": "Don Mun",
        "ดอนเมือง": "Don Mueang",
        "ดอนรัก": "Ban Don Rak",
        "ดอนเรียบ": "Ban Don Riap",
        "ดอนสีนนท์": "Don Si Non",
        "ดอนหญ้านาง": "Don Ya Nang",
        "ด่านพรมแดนบ้านคลองลึก": "Ban Khlong Luek Border",
        "ด่าน": "Ban Dan",
        "ดารา": "Ban Dara Junction",
        "ดินลาน": "Ban Din Lan",
        "เด่นชัย": "Den Chai",
        "เดื่อ": "Huai Duea",
        "โดยสาร": "Coach",
        "ดงบัง": "Ban Dong Bang",
        "ดงตะขบ": "Dong Takhop",
        "ดงมะกุ": "Dong Maku",
        "ดวด": "Ban Duat",
        "ตลาดน้ำ 4 ภาค": "Talat Nam Si Phak",
        "ตลาดใหม่ดอนเมือง": "Talat Mai Don Mueang",
        "ตลาดหนองคาย": "Talat Nong Khai",
        "ตลาดพลู": "Talat Phlu",
        "ตลาดลำนารายณ์": "Talat Lam Narai",
        "ตะกอ": "Ban Tako",
        "ตะโก": "Pak Tako",
        "ตะขบ": "Dong Takhop",
        "ตะเคียน": "Wang Takhian",
        "ตันหยงมัส": "Tanyong Mat",
        "ตาเกษม": "Tha Kasem",
        "ตาคลี": "Ban Takhli",
        "ตาเซะ": "Ta Se",
        "ตานี": "Pattani (Khok Pho)",
        "ตาเนิน": "Ban Ta Noen",
        "ตาแปด": "Ta Paet",
        "ตาเสือ": "Tha Ta Suea",
        "ตำบล": "Tambon",
        "ตูม": "Ban Tum",
        "เต็งหนาม": "Ban Teng Nam",
        "เต่า": "Nong Tao",
        "โตนด": "Laem Tanot",
        "โต๊ะเด็ง": "To Deng",
        "ใต้": "Pattaya Tai",
        "ไตร": "Wat Sai",
        "ตรัง": "Trang",
        "ตรอน": "Tron",
        "ตลิ่งชัน": "Taling Chan Junction",
        "ตะกั่วป่า": "Takua Pa",
        "ถ้ำกระแซ": "Tham Krasae Bridge",
        "ทับกฤช": "Thap Krit",
        "ทับช้าง": "Ban Thap Chang",
        "ทับทัน": "Huai Thap Than",
        "ทับสะแก": "Thap Sakae",
        "ทับกวาง": "Thap Kwang",
        "ทลุง": "Phatthalung",
        "ทวาย": "Dawei",
        "ทอง": "Phaen Din Thong",
        "ทะเลหว้า": "Thale Wa",
        "ทุ่งคา": "Thung Kha",
        "ทุ่งค่าย": "Ban Thung Khai",
        "ทุ่งช้าง": "Thung Chang",
        "ทุ่งทอง": "Thung Thong",
        "ทุ่งบัว": "Thung Bua",
        "ทุ่งประดู่": "Thung Pradu",
        "ทุ่งมะพร้าว": "Thung Maphrao",
        "ทุ่งมะเม่า": "Thung Mamao",
        "ทุ่งสองห้อง": "Thung Song Hong",
        "ทุ่งสีทอง": "Thung Si Thong",
        "ทุ่งหลวง": "Ban Thung Luang",
        "ทุ่งหล่อ": "Ban Thung Lo",
        "ทุ่งอิฐ": "Thung It",
        "ทุ่งโพธิ์": "Ban Thung Pho Junction",
        "ทุ่งสง": "Thung Song Junction",
        "ท่าเกษม": "Tha Kasem",
        "ท่าข้าม": "Tha Kham",
        "ท่าข้าม": "Tha Kham",
        "ท่าแฉลบ": "Tha Chalaep",
        "ท่าช้าง": "Tha Chang",
        "ท่าชนะ": "Tha Chana",
        "ท่าชมภู": "Tha Chomphu",
        "ท่าฉลอม": "Tha Chalom",
        "ท่าฉาง": "Tha Chang",
        "ท่าตาเสือ": "Tha Ta Suea",
        "ท่าทอง": "Tha Thong",
        "ท่านุ่น": "Tha Nun",
        "ท่าพระ": "Tha Phra",
        "ท่าม่วง": "Tha Muang",
        "ท่ายาง": "Tha Yang",
        "ท่าเรือ": "Tha Ruea",
        "ท่าเรือน้อย": "Tha Ruea Noi",
        "ท่าศาลา": "Tha Sala",
        "ท่าสัก": "Tha Sak",
        "ท่าเสา": "Tha Sao",
        "ท่าฬ่อ": "Tha Lo",
        "ท่าอิฐ": "Tha It",
        "ทับกฤช": "Thap Krit",
        "ทับช้าง": "Ban Thap Chang",
        "ทับทัน": "Huai Thap Than",
        "ทับสะแก": "Thap Sakae",
        "ทับกวาง": "Thap Kwang",
        "ทุ่งคา": "Thung Kha",
        "ทุ่งค่าย": "Ban Thung Khai",
        "ทุ่งช้าง": "Thung Chang",
        "ทุ่งทอง": "Thung Thong",
        "ทุ่งบัว": "Thung Bua",
        "ทุ่งประดู่": "Thung Pradu",
        "ทุ่งมะพร้าว": "Thung Maphrao",
        "ทุ่งมะเม่า": "Thung Mamao",
        "ทุ่งสองห้อง": "Thung Song Hong",
        "ทุ่งสีทอง": "Thung Si Thong",
        "ทุ่งหลวง": "Ban Thung Luang",
        "ทุ่งหล่อ": "Ban Thung Lo",
        "ทุ่งอิฐ": "Thung It",
        "ทุ่งโพธิ์": "Ban Thung Pho Junction",
        "ทุ่งสง": "Thung Song Junction",
        "ธนบุรี": "Thon Buri",
        "ธรรมศาสตร์": "Thammasat University (Rangsit)",
        "ธัญบุรี": "Thanyaburi",
        "นครชัยศรี": "Nakhon Chai Si",
        "นครชุมน์": "Nakhon Chum",
        "นครปฐม": "Nakhon Pathom",
        "นครราชสีมา": "Nakhon Ratchasima",
        "นครลำปาง": "Nakhon Lampang",
        "นครศรีธรรมราช": "Nakhon Si Thammarat",
        "นครสวรรค์": "Nakhon Sawan",
        "นพวงศ์": "Nopphawong",
        "นวนคร": "Nawa Nakhon",
        "นวล": "Nuan",
        "น้อง": "Nong",
        "นาบอน": "Na Bon",
        "นาปรือ": "Na Prue",
        "นาป้อ": "Na Po",
        "นาผักขวง": "Na Phak Khuang",
        "นาสาร": "Na San",
        "นาทา": "Na Tha",
        "นาทุ่ง": "Na Thung",
        "นาม่วง": "Na Muang",
        "นาหว้า": "Na Wa",
        "นาแห้ว": "Na Haeo",
        "น้ำตก": "Nam Tok",
        "น้ำตกไทรโยคน้อย": "Sai Yok Noi Waterfall",
        "น้ำพอง": "Nam Phong",
        "นิคม": "Ban Nikhom",
        "นิคมรถไฟ กม.11": "Nikhom Rotfai KM.11",
        "เนินมะกอก": "Noen Makok",
        "เนินสวัสดิ์": "Noen Sawat",
        "เนียม": "Ban Niam",
        "ในเมือง": "Nai Mueang",
        "บ่อนอก": "Bo Nok",
        "บ่อตะคร้อ": "Bo Takhro",
        "บ่อแฮ้ว": "Bo Haeo",
        "บ่อกรัง": "Bo Krang",
        "บางกระทุ่ม": "Bang Krathum",
        "บางกระบูน": "Bang Krabun",
        "บางกล่ำ": "Bang Klam",
        "บางแก้ว": "Bang Kaeo",
        "บางขวัญ": "Bang Khwan",
        "บางเขน": "Bang Khen",
        "บางจาก": "Bang Chak",
        "บางซ่อน": "Bang Son",
        "บางตาล": "Khlong Bang Tan",
        "บางไทร": "Bang Sai",
        "บางน้ำจืด": "Bang Nam Chuet",
        "บางน้ำเปรี้ยว": "Bang Nam Priao",
        "บางบอน": "Bang Bon",
        "บางบำหรุ": "Bang Bamru",
        "บางปะอิน": "Bang Pa-in",
        "บางปาก": "Bang Pak",
        "บางปู": "Bang Pu",
        "บางพลี": "Bang Phli",
        "บางพระ": "Bang Phra",
        "บางโพ": "Bang Pho",
        "บางมูนาก": "Bang Mun Nak",
        "บางระมาด": "Bang Ramat",
        "บางสะพานน้อย": "Bang Saphan Noi",
        "บางสะพานใหญ่": "Bang Saphan Yai",
        "บางสีคต": "Bang Si Khot",
        "บางอ้อ": "Bang O",
        "บ้านกกกว้าว": "Ban Kok Kwao",
        "บ้านกลับ": "Ban Klap",
        "บ้านกลอย": "Ban Kloi",
        "บ้านกล้วย": "Ban Kluai",
        "บ้านกะลัน": "Ban Kalan",
        "บ้านกรูด": "Ban Krut",
        "บ้านเกาะ": "Ban Ko",
        "บ้านเกาะรัง": "Ban Ko Rang",
        "บ้านเกาะใหญ่": "Ban Ko Yai",
        "บ้านเก่า": "Ban Kao",
        "บ้านเก่า" : "Ban Kao",
        "บ้านแก้ง": "Ban Kaeng",
        "บ้านขอม": "Ban Khom",
        "บ้านขอนหาด": "Ban Khon Hat",
        "บ้านขนาย": "Ban Khanai",
        "บ้านค่ายไทย": "Ban Khai Thai",
        "บ้านคอกม้า": "Ban Khok Ma",
        "บ้านคูบัว": "Ban Khu Bua",
        "บ้านแคน": "Ban Khaen",
        "บ้านโคกกระเบื้อง": "Ban Khok Krabueang",
        "บ้านโคน": "Ban Khon",
        "บ้านงิ้ว": "Ban Ngiu",
        "บ้านจงโก": "Ban Chong Ko",
        "บ้านฉาง": "Ban Chang",
        "บ้านฉิมพลี": "Ban Chimphli",
        "บ้านช่องใต้": "Ban Chong Tai",
        "บ้านชีผ้าขาว": "Ban Chi Phakhao",
        "บ้านซับม่วง": "Ban Sap Muang",
        "บ้านด่าน": "Ban Dan",
        "บ้านดงบัง": "Ban Dong Bang",
        "บ้านดงพลอง": "Ban Dong Phlong",
        "บ้านดอนกลาง": "Ban Don Klang",
        "บ้านดอนรัก": "Ban Don Rak",
        "บ้านดอนเรียบ": "Ban Don Riap",
        "บ้านดวด": "Ban Duat",
        "บ้านตาคลี": "Ban Takhli",
        "บ้านตาเนิน": "Ban Ta Noen",
        "บ้านตูล": "Ban Tun",
        "บ้านเต็งหนาม": "Ban Teng Nam",
        "บ้านใต้": "Ban Tai",
        "บ้านทรายทอง": "Ban Sai Thong",
        "บ้านทับช้าง": "Ban Thap Chang",
        "บ้านท่าช้าง": "Ban Tha Chang",
        "บ้านทุ่งค่าย": "Ban Thung Khai",
        "บ้านทุ่งโพธิ์": "Ban Thung Pho Junction",
        "บ้านทุ่งหลวง": "Ban Thung Luang",
        "บ้านธาตุ": "Ban That",
        "บ้านนา": "Ban Na",
        "บ้านนาขวาง": "Ban Na Khwang",
        "บ้านนาโคก": "Ban Na Khok",
        "บ้านนิคม": "Ban Nikhom",
        "บ้านเนียม": "Ban Niam",
        "บ้านบ่อ": "Ban Bo",
        "บ้านบึง": "Ban Bueng",
        "บ้านปิน": "Ban Pin",
        "บ้านป๊อกแป๊ก": "Ban Pokpaek",
        "บ้านโป่ง": "Ban Pong",
        "บ้านโป่งคอม": "Ban Pong Kom",
        "บ้านโป่งเสี้ยว": "Ban Pong Siao",
        "บ้านป่าไก่": "Ban Pa Kai",
        "บ้านป่าหวาย": "Ban Pa Wai",
        "บ้านปากจาบ": "Ban Pak Chap",
        "บ้านปากพลี": "Ban Pak Phli",
        "บ้านปาแต": "Ban Pa Tae",
        "บ้านผือ": "Ban Phue",
        "บ้านไผ่": "Ban Phai",
        "บ้านไผ่ใหญ่": "Phai Yai",
        "บ้านพรุกระแชง": "Ban Phru Krachaeng",
        "บ้านพลวง": "Ban Phluang",
        "บ้านพลูตาหลวง": "Ban Phlu Ta Luang",
        "บ้านพุพงษ์": "Ban Phu Phong",
        "บ้านโพ": "Ban Pho",
        "บ้านมะค่า": "Ban Makha",
        "บ้านมะขามล้ม": "Ban Makham Lom",
        "บ้านมะกอกใต้": "Ban Makok Tai",
        "บ้านใหม่": "Ban Mai",
        "บ้านใหม่สำโรง": "Ban Mai Samrong",
        "บ้านยาง": "Ban Yang",
        "บ้านยุโป": "Ban Yupo",
        "บ้านไร่": "Ban Rai",
        "บ้านสร้าง": "Ban Sang",
        "บ้านส้อง": "Ban Song",
        "บ้านสะโลว์บูกิตยือแร": "Ban Salo Bukit Yuerae",
        "บ้านสระครก": "Ban Sa Khrok",
        "บ้านสุนทรา": "Ban Sunthra",
        "บ้านหมอ": "Ban Mo",
        "บ้านหมี่": "Ban Mi",
        "บ้านเหลื่อม": "Ban Lueam",
        "บ้านแหลม": "Ban Laem",
        "บ้านแฮด": "Ban Haet",
        "บำเหน็จณรงค์": "Bamnet Narong",
        "บึงบอระเพ็ด": "Bueng Boraphet",
        "บึงพระ": "Bueng Phra",
        "บูกิต": "Bukit",
        "บุใหญ่": "Bu Yai",
        "บุรีรัมย์": "Buri Ram",
        "เบซาร์": "Padang Besar",
        "เบญจมบพิตร": "Wat Benchamabophit",
        "บึงกาฬ": "Bueng Kan",
        "ปากช่อง": "Pak Chong",
        "ปากท่อ": "Pak Tho",
        "ปากน้ำ": "Pak Nam",
        "ปากน้ำโพ": "Pak Nam Pho",
        "ปากปาน": "Pak Pan",
        "ปากแพรก": "Pak Phraek",
        "ปากตะโก": "Pak Tako",
        "ปากคลอง": "Pak Khlong",
        "ปางป๋วย": "Pang Puai",
        "ปางม่วง": "Pang Muang",
        "ปางอโศก": "Pang Asok",
        "ปางต้นผึ้ง": "Pang Ton Phueng",
        "ปัตตานี (โคกโพธิ์)": "Pattani (Khok Pho)",
        "ปาดังเบซาร์": "Padang Besar",
        "ป่าไร่": "Pa Rai",
        "ป่าไผ่": "Pa Phai",
        "เปร็ง": "Preng",
        "โป่ง": "Ban Pong",
        "แปดริ้ว": "Paet Riu",
        "ผาคัน": "Pha Khan",
        "ผาคอ": "Pha Kho",
        "ผาเสด็จ": "Pha Sadet",
        "ผาลาด": "Sala Pha Lat",
        "แผ่นดินทอง": "Phaen Din Thong",
        "ไผ่ใหญ่": "Phai Yai",
        "พญาไท": "Phaya Thai",
        "พรหมพิราม": "Phrom Phiram",
        "พรุพี": "Phru Phi",
        "พรุใหญ่": "Phru Yai",
        "พระจอมเกล้า": "Phra Chom Klao",
        "พระปรง": "Phra Prong",
        "พระพุทธฉาย": "Phra Phutthachai",
        "พระแก้ว": "Phra Kaeo",
        "พลวง": "Ban Phluang",
        "พลูตาหลวง": "Ban Phlu Ta Luang",
        "พลี": "Saphli",
        "พะเยา": "Phayao",
        "พังงา": "Phang Nga",
        "พัทลุง": "Phatthalung",
        "พัทยา": "Pattaya",
        "พัทยาใต้": "Pattaya Tai",
        "พานทอง": "Phan Thong",
        "พิจิตร": "Phichit",
        "พิชัย": "Phichai",
        "พิบูลมังสาหาร": "Phibun Mangsahan",
        "พิษณุโลก": "Phitsanulok",
        "พุพงษ์": "Ban Phu Phong",
        "เพชรบุรี": "Phetchaburi",
        "เพชรบูรณ์": "Phetchabun",
        "โพนทอง": "Phon Thong",
        "โพรงมะเดื่อ": "Phrong Maduea",
        "โพรงอากาศ": "Phrong Akat",
        "โพธาราม": "Photharam",
        "โพธิ์": "Ban Pho",
        "ไพร": "Phrai",
        "ฟัก": "Nong Fak",
        "ภูเขา": "Phu Khao",
        "ภูเก็ต": "Phuket",
        "มวกเหล็ก": "Muak Lek",
        "มวกเหล็กใหม่": "New Muak Lek",
        "มหาชัย": "Maha Chai",
        "มหาสารคาม": "Maha Sarakham",
        "มะกอก": "Noen Makok",
        "มะกอกใต้": "Ban Makok Tai",
        "มะค่า": "Ban Makha",
        "มะม่วงสองต้น": "Mamuang Song Ton",
        "มะลวน": "Maluan",
        "มะรือโบ": "Maruebo",
        "มักกะสัน": "Makkasan",
        "มาบกะเบา": "Map Kabao",
        "มาบอำมฤต": "Map Ammarit",
        "มาบตาพุด": "Map Ta Phut",
        "มาลัยแมน": "Malaiman",
        "มิ่งเมือง": "Ming Mueang",
        "มีด": "Wat Khuan Mit",
        "เมืองคง": "Mueang Khong",
        "เมืองที": "Mueang Thi",
        "เมืองพล": "Mueang Phon",
        "แม่กลอง": "Mae Klong",
        "แม่จาง": "Mae Chang",
        "แม่ใจ": "Mae Chai",
        "แม่น้ำ": "Mae Nam",
        "แม่น้ำ (โรงกลั่นน้ำมันบางจาก)": "Mae Nam (Bangchak Oil Refinery)",
        "แม่พวก": "Mae Phuak",
        "แม่เมาะ": "Mae Mo",
        "แม่ริม": "Mae Rim",
        "แม่สอด": "Mae Sot",
        "แม่สาย": "Mae Sai",
        "แม่ทะ": "Mae Tha",
        "แม่เทียบ": "Mae Thiap",
        "แม่ฮ่องสอน": "Mae Hong Son",
        "ไม้แก่น": "Mai Kaen",
        "ยมราช": "Yommarat",
        "ยะลา": "Yala",
        "ยาง": "Ban Yang",
        "ยางตลาด": "Yang Talat",
        "ยางยวน": "Yang Yuan",
        "ยางประสาท": "Yang Prasat",
        "ยานนาวา": "Yan Nawa",
        "ยี่สิบเอ็ด": "Khlong Yi Sip Et",
        "ยุโป": "Ban Yupo",
        "โยทะกา": "Yothaka",
        "รังสิต": "Rangsit",
        "ร่อนพิบูลย์": "Ron Phibun",
        "ร้อยเอ็ด": "Roi Et",
        "ระนอง": "Ranong",
        "ระยอง": "Rayong",
        "ราชบุรี": "Ratchaburi",
        "ราชปรารภ": "Ratchaprarop",
        "รามัน": "Raman",
        "รามาธิบดี": "Ramathibodi Hospital",
        "รางโพธิ์": "Rang Pho",
        "รางสะแก": "Rang Sakae",
        "ไร่เกล็ดดาว": "Rai Klet Dao",
        "ไร่อ้อย": "Rai Oi",
        "โรงเรียนจันเสน": "Rongrian Chansen",
        "โรงเรียนนายร้อยพระจุลจอมเกล้า": "Chulachomklao Royal Military Academy",
        "โรงเรียนการบิน": "Flying School",
        "โรงพยาบาลรามาธิบดี": "Ramathibodi Hospital",
        "ลพบุรี": "Lop Buri",
        "ลพบุรีราเมศวร์": "Lop Buri Ramet",
        "ละแม": "Lamae",
        "ลำชี": "Lam Chi",
        "ลำดวน": "Lamduan",
        "ลำนารายณ์": "Lam Narai",
        "ลำปาง": "Nakhon Lampang",
        "ลำปลายมาศ": "Lam Plai Mat",
        "ลำพูน": "Lamphun",
        "ลำภูรา": "Lamphu Ra",
        "ลาดกระบัง": "Lat Krabang",
        "ลาดใหญ่": "Lat Yai",
        "ลาโละ": "Lalo",
        "ลานบุญ": "Soi Wat Lan Bun",
        "ลุ่มสุ่ม": "Lumsum",
        "ลูกแก": "Luk Kae",
        "เลย": "Loei",
        "วังกะพี้": "Wang Kapi",
        "วังกะอาม": "Wang Ka-am",
        "วังกรด": "Wang Krot",
        "วังกร่าง": "Wang Krang",
        "วังด้วน": "Wang Duan",
        "วังตะเคียน": "Wang Takhian",
        "วังเย็น": "Wang Yen",
        "วังใหญ่": "Wang Yai",
        "วังสิงห์": "Wang Sing",
        "วังโพ": "Wang Pho",
        "วัดไทร": "Wat Sai",
        "วัดสิงห์": "Wat Sing",
        "วัดสุวรรณ": "Wat Suwan",
        "วัดช้างให้": "Wat Chang Hai",
        "วัดไทร": "Wat Sai",
        "วัดสิงห์": "Wat Sing",
        "วัดสุวรรณ": "Wat Suwan",
        "วัฒนานคร": "Watthana Nakhon",
        "วารินชำราบ": "Warin Chamrap",
        "วิหารแดง": "Wihan Daeng",
        "วิสัย": "Wisai",
        "ศรีสะเกษ": "Si Sa Ket",
        "ศรีราชา": "Si Racha Junction",
        "ศรีสำราญ": "Si Samran",
        "ศีขรภูมิ": "Sikhoraphum",
        "ศาลายา": "Salaya",
        "ศาลาธรรมสพน์": "Sala Thammasop",
        "ศาลาผาลาด": "Sala Pha Lat",
        "ศาลาแม่ทา": "Sala Mae Tha",
        "ศาลาลำดวน": "Sala Lamduan",
        "ศิลาอาสน์": "Sila At",
        "สระแก้ว": "Sa Kaeo",
        "สระบุรี": "Saraburi",
        "สระโกสินารายณ์": "Sa Kosinarai",
        "สวรรคโลก": "Sawankhalok",
        "สวี": "Sawi",
        "สัตหีบ": "Sattahip",
        "สามกระทาย": "Sam Krathai",
        "สามแยก": "Sam Yaek",
        "สามร้อยยอด": "Sam Roi Yot",
        "สามเสน": "Sam Sen",
        "สำราญ": "Samran",
        "สีคิ้ว": "Sikhio",
        "สีดา": "Sida",
        "สุขุมวิท 71": "Sukhumvit 71",
        "สุโขทัย": "Sukhothai",
        "สุไหงโก-ลก": "Su-ngai Kolok",
        "สุไหงปาดี": "Su-ngai Padi",
        "สุพรรณบุรี": "Suphan Buri",
        "สุราษฎร์ธานี": "Surat Thani",
        "สุรินทร์": "Surin",
        "สุรนารายณ์": "Suranarai",
        "สูงเนิน": "Sung Noen",
        "เสือ": "Ban Nong Suea",
        "เสือเต้น": "Kaeng Suea Ten",
        "แสงแดด": "Saeng Daet",
        "แสน": "Sam Saen",
        "ห้วยขวาง": "Huai Khwang",
        "ห้วยขยุง": "Huai Khayung",
        "ห้วยเกตุ": "Huai Ket",
        "ห้วยเกิ้ง": "Huai Koeng",
        "ห้วยแก้ว": "Huai Kaeo",
        "ห้วยโจด": "Huai Chot",
        "ห้วยเดื่อ": "Huai Duea",
        "ห้วยทับทัน": "Huai Thap Than",
        "ห้วยแถลง": "Huai Thalaeng",
        "ห้วยปริก": "Huai Prik",
        "ห้วยแม่ต้า": "Huai Mae Ta",
        "ห้วยยายจิ๋ว": "Huai Yai Chio",
        "ห้วยยอด": "Huai Yot",
        "ห้วยราช": "Huai Rat",
        "ห้วยรากไม้": "Huai Rak Mai",
        "ห้วยไร่": "Huai Rai",
        "ห้วยเรียน": "Huai Rian",
        "ห้วยสัก": "Huai Sak",
        "ห้วยสามพาด": "Huai Sam Phat",
        "หนองคาย": "Nong Khai",
        "หนองคาง": "Nong Khang",
        "หนองขอนกว้าง": "Nong Khon Kwang",
        "หนองขาม": "Ban Nong Kham",
        "หนองไข่น้ำ": "Nong Khai Nam",
        "หนองจอก": "Nong Chok",
        "หนองจิก": "Nong Chik",
        "หนองฉิม": "Nong Chim",
        "หนองแซง": "Nong Saeng",
        "หนองตะไก้": "Nong Takai",
        "หนองเต่า": "Nong Tao",
        "หนองเต็ง": "Nong Teng",
        "หนองตม": "Nong Tom",
        "หนองบัว": "Nong Bua",
        "หนองบัวลาย": "Nong Bua Lai",
        "หนองปลาไหล": "Nong Pla Lai",
        "หนองปลาดุก": "Nong Pladuk Junction",
        "หนองปรือโป่ง": "Ban Nong Prue Pong",
        "หนองปากโลง": "Nong Pak Long",
        "หนองผักชี": "Nong Phak Chi",
        "หนองโพ": "Nong Pho",
        "หนองพลวง": "Nong Phluang",
        "หนองพยอม": "Non Phayom",
        "หนองมะเขือ": "Nong Makhuea",
        "หนองมงคล": "Nong Mongkhon",
        "หนองรี": "Nong Ri",
        "หนองเรียง": "Nong Riang",
        "หนองวัลย์เปรียง": "Nong Wan Priang",
        "หนองวัวเฒ่า": "Nong Wua Thao",
        "หนองศาลา": "Nong Sala",
        "หนองสัง": "Nong Sang",
        "หนองหิน": "Nong Hin",
        "หนองแก": "Nong Kae",
        "หนองโดน": "Nong Don",
        "หนองโพ": "Nong Pho",
        "หนองไม้เหลือง": "Nong Mai Lueang",
        "หนองหล่ม": "Nong Lom",
        "หน้าพระลาน": "Na Phra Lan",
        "หมอ": "Ban Mo",
        "หมี่": "Ban Mi",
        "หลักสี่": "Lak Si",
        "หลักหก": "Lak Hok",
        "หลังสวน": "Lang Suan",
        "หันคา": "Hankha",
        "หัวตะเข้": "Hua Takhe",
        "หัวดง": "Hua Dong",
        "หัวหิน": "Hua Hin",
        "หัวหมาก": "Hua Mak",
        "หัวหวาย": "Hua Wai",
        "หัวงิ้ว": "Hua Ngiu",
        "ห้างฉัตร": "Hang Chat",
        "หารกง": "Han Kong",
        "หารเทา": "Han Thao",
        "หินกอง": "Hin Kong",
        "หินซ้อน": "Hin Son",
        "หินลับ": "Hin Lap",
        "หินดาต": "Hin Dat",
        "หอไกร": "Ho Krai",
        "องครักษ์": "Ongkharak",
        "อรัญประเทศ": "Aranyaprathet",
        "อโศก": "Asok",
        "ออสเตรเลีย": "Australia",
        "อ้อมน้อย": "Om Noi",
        "อ่างทอง": "Ang Thong",
        "อุดรธานี": "Udon Thani",
        "อุตรดิตถ์": "Uttaradit",
        "อุบลราชธานี": "Ubon Ratchathani",
        "อุทุมพรพิสัย": "Uthumphon Phisai",
        "อุรุพงษ์": "Uruphong",
        "อู่ตะเภา": "U-Tapao",
        "ไอสะเตีย": "Ai Satia",
    };

    // --- DOM ELEMENTS ---
    const form = document.getElementById('announcementForm');
    const reasonSelect = document.getElementById('reason');
    const locationTypeSelect = document.getElementById('locationType');
    const outputArea = document.getElementById('outputArea');

    // --- HELPER FUNCTIONS ---
    function translate(thaiName) { return stationTranslation[thaiName] || thaiName; }

    function populateDatalist(elementId, items) {
        const datalist = document.getElementById(elementId);
        datalist.innerHTML = ''; // Clear existing options
        items.forEach(item => {
            const option = document.createElement('option');
            option.value = item;
            datalist.appendChild(option);
        });
    }

    function toggleElement(elementId, show) {
        const element = document.getElementById(elementId);
        if (element) {
            element.classList.toggle('hidden', !show);
        }
    }

    function updateConditionalFields() {
        const reason = reasonSelect.value;
        toggleElement('carriageNumberWrapper', ['2', '5'].includes(reason));
        toggleElement('carriageChangeWrapper', reason === '18');
        toggleElement('unavailableCarriageWrapper', reason === '19');
    }

    function updateLocationFields() {
        const type = locationTypeSelect.value;
        toggleElement('locationAtStationWrapper', type === 'at_station');
        toggleElement('locationBetweenWrapper', type === 'between_stations');
    }

    function copyToClipboard(elementId, buttonElement) {
        const textToCopy = document.getElementById(elementId).textContent;
        const textArea = document.createElement('textarea');
        
        // Prevent scrolling to bottom of page in MS Edge.
        textArea.style.position = 'fixed';
        textArea.style.top = '0';
        textArea.style.left = '0';
        textArea.style.width = '2em';
        textArea.style.height = '2em';
        textArea.style.padding = '0';
        textArea.style.border = 'none';
        textArea.style.outline = 'none';
        textArea.style.boxShadow = 'none';
        textArea.style.background = 'transparent';
        
        textArea.value = textToCopy;
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();

        try {
            const successful = document.execCommand('copy');
            if(successful){
                const originalText = buttonElement.innerHTML;
                buttonElement.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check"><path d="M20 6 9 17l-5-5"/></svg>
                    <span>คัดลอกแล้ว</span>`;
                showToast();
                setTimeout(() => {
                    buttonElement.innerHTML = originalText;
                }, 2000);
            }
        } catch (err) {
            console.error('Could not copy text: ', err);
        }

        document.body.removeChild(textArea);
    }

    function showToast() {
        const toast = document.getElementById('toast');
        toast.classList.remove('opacity-0');
        setTimeout(() => {
            toast.classList.add('opacity-0');
        }, 2000);
    }

    // A simple phrase-based translation for the notes field
    function translateNotes(notes) {
        return notes.replace(/ผู้โดยสารสามารถติดต่อขอรับคืนเงินค่าตั๋วโดยสารได้ที่สถานีปลายทาง/g, 'Passengers can request a ticket refund at the destination station.')
            .replace(/จะมีการประกาศข้อมูลเพิ่มเติมในอีก (\d+) นาที/g, 'A further announcement will be made in approximately $1 minutes.')
            .replace(/ผู้โดยสารที่มีความประสงค์จะสละสิทธิ์การเดินทาง สามารถลงจากขบวนรถได้/g, 'Passengers who wish to forfeit their journey may disembark.')
            .replace(/จากรถพัดลมเป็นรถปรับอากาศ โดยไม่มีการเก็บค่าโดยสารเพิ่มเติม/g, 'The carriage has been upgraded from a fan car to an air-conditioned car at no extra charge.')
            .replace(/หากผู้โดยสารเดินทางพร้อมสัตว์เลี้ยง โปรดติดต่อเจ้าหน้าที่สถานีก่อนขึ้นขบวนรถ/g, 'Additionally, passengers traveling with pets are requested to contact station staff before boarding.')
            .replace(/ผู้โดยสาร/g, 'Passengers').replace(/ติดต่อ/g, 'contact').replace(/ขอรับ/g, 'request')
            .replace(/คืนเงิน/g, 'a refund').replace(/ค่าตั๋ว/g, 'for tickets').replace(/สถานีปลายทาง/g, 'the destination station')
            .replace(/ประกาศเพิ่มเติม/g, 'further announcements').replace(/นาที/g, 'minutes').replace(/ชั่วโมง/g, 'hours')
            .replace(/สละสิทธิ์/g, 'forfeit the journey').replace(/ลงจากขบวนรถ/g, 'disembark the train');
    }

    // --- MAIN LOGIC ---
    form.addEventListener('submit', function(event) {
        event.preventDefault();

        // 1. Gather Data from Form
        const formData = {
            trainType: document.getElementById('trainType').value,
            trainNumber: document.getElementById('trainNumberInput').value,
            origin: document.getElementById('origin').value,
            destination: document.getElementById('destination').value,
            reasonKey: document.getElementById('reason').value,
            locationType: document.getElementById('locationType').value,
            locationStation: document.getElementById('locationStation').value.trim(),
            locationBetween1: document.getElementById('locationBetween1').value.trim(),
            locationBetween2: document.getElementById('locationBetween2').value.trim(),
            actionKey: document.getElementById('actionTaken').value,
            delayTime: document.getElementById('delayTime').value.trim(),
            instructionKey: document.getElementById('instruction').value,
            notes: document.getElementById('notes').value.trim(),
            otherTrainsAffected: document.getElementById('otherTrainsAffected').checked,
            carriageNumber: document.getElementById('carriageNumber').value.trim(),
            carriageChangeType: document.getElementById('carriageChangeType').value,
            unavailableDate: document.getElementById('unavailableDate').value,
            unavailableCarriageType: document.getElementById('unavailableCarriageType').value
        };

        // 2. Process and Build Announcement Parts
        // Thai Parts
        const thaiParts = {};
        if (formData.trainNumber && formData.origin && formData.destination) {
            thaiParts.trainId = `ขบวน${formData.trainType}ที่ ${formData.trainNumber} (${formData.origin} - ${formData.destination})`;
        } else {
            thaiParts.trainId = "ประกาศการเดินรถ";
        }

        if (formData.locationType === 'at_station' && formData.locationStation) {
            thaiParts.location = `ที่สถานี ${formData.locationStation}`;
        } else if (formData.locationType === 'between_stations' && formData.locationBetween1 && formData.locationBetween2) {
            thaiParts.location = `ระหว่างสถานี ${formData.locationBetween1} - ${formData.locationBetween2}`;
        }
        thaiParts.action = actions.thai[formData.actionKey];
        if (formData.delayTime) {
             thaiParts.impact = `ซึ่งจะทำให้ขบวนรถล่าช้าประมาณ ${formData.delayTime}`;
        } else if (formData.reasonKey !== '18' && formData.reasonKey !== '19' && formData.reasonKey !== '6') { // No default delay message for specific reasons
             thaiParts.impact = 'ซึ่งจะทำให้ขบวนรถล่าช้า';
        }
        thaiParts.instruction = instructions.thai[formData.instructionKey];
        thaiParts.notes = formData.notes;
        if (formData.otherTrainsAffected) {
            thaiParts.affected = "อาจส่งผลกระทบต่อขบวนรถอื่น";
        }
        // Specific reason handling for Thai
        let reasonStrThai = reasons[formData.reasonKey].thai;
        if (formData.reasonKey === '18') {
             thaiParts.mainClause = `${carriageChangeMap[formData.carriageChangeType].thai}${thaiParts.location ? ' ' + thaiParts.location : ''}`;
        } else if (formData.reasonKey === '19' && formData.unavailableDate) {
            const date = new Date(formData.unavailableDate);
            const formattedDate = date.toLocaleDateString('th-TH', { day: 'numeric', month: 'short', year: 'numeric' });
            thaiParts.mainClause = `ในวันที่ ${formattedDate} ${formData.unavailableCarriageType} ไม่มีให้บริการ`;
        } else {
             if (formData.carriageNumber) reasonStrThai += ` (${formData.carriageNumber})`;
             let prefix = (['3', '6', '7', '13', '17'].includes(formData.reasonKey)) ? '' : 'เกิดเหตุ';
             thaiParts.mainClause = `${prefix}${reasonStrThai}${thaiParts.location ? ' ' + thaiParts.location : ''}`;
        }
        
        // English Parts
        const englishParts = {};
        if (formData.trainNumber && formData.origin && formData.destination) {
             englishParts.trainId = `${trainTypeMap[formData.trainType]} No. ${formData.trainNumber} (${translate(formData.origin)} - ${translate(formData.destination)})`;
        } else {
            englishParts.trainId = "Service Announcement";
        }

        if (formData.locationType === 'at_station' && formData.locationStation) {
            englishParts.location = `at ${translate(formData.locationStation)} station`;
        } else if (formData.locationType === 'between_stations' && formData.locationBetween1 && formData.locationBetween2) {
            englishParts.location = `between ${translate(formData.locationBetween1)} and ${translate(formData.locationBetween2)} stations`;
        }
        englishParts.action = actions.english[formData.actionKey];
        if (formData.delayTime) {
            const delayTimeEn = formData.delayTime.replace('นาที', 'minutes').replace('ชั่วโมง', 'hours');
            englishParts.impact = `A delay of approximately ${delayTimeEn} is expected.`;
        } else if (formData.reasonKey !== '18' && formData.reasonKey !== '19' && formData.reasonKey !== '6') {
            englishParts.impact = "This will cause a delay.";
        }
        englishParts.instruction = instructions.english[formData.instructionKey];
        englishParts.notes = formData.notes ? translateNotes(formData.notes) : '';
        if (formData.otherTrainsAffected) {
            englishParts.affected = "This incident may affect other trains on this route.";
        }
        // Specific reason handling for English
        let reasonStrEn = reasons[formData.reasonKey].english;
        if (formData.reasonKey === '18') {
             englishParts.mainClause = `will have ${carriageChangeMap[formData.carriageChangeType].english}`;
        } else if (formData.reasonKey === '19' && formData.unavailableDate) {
             const date = new Date(formData.unavailableDate);
             const formattedDateEn = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
             englishParts.mainClause = `On ${formattedDateEn}, the ${unavailableCarriageMap[formData.unavailableCarriageType]} will be unavailable.`;
        } else {
            if (formData.carriageNumber) reasonStrEn += ` (Car No. ${formData.carriageNumber.replace('คันที่', '').trim()})`;
            let verb = (['3', '6', '7', '13', '17'].includes(formData.reasonKey)) ? 'is' : 'is experiencing a disruption due to';
            englishParts.mainClause = `${verb} ${reasonStrEn}${englishParts.location ? ' ' + englishParts.location : ''}`;
        }
       
        // 3. Assemble the final sentences
        const partOrder = ['trainId', 'mainClause', 'action', 'impact', 'instruction', 'notes', 'affected'];
        const finalThaiParts = partOrder.map(p => thaiParts[p]).filter(Boolean); // Filter out empty/undefined parts
        const finalEnglishParts = partOrder.map(p => englishParts[p]).filter(Boolean);

        const thaiText = `${finalThaiParts.join('. ')}. ขออภัยในความไม่สะดวก`;
        const englishText = `Notice: ${finalEnglishParts.join(' ')}. We apologize for the inconvenience.`;

        // 4. Build Ticker Announcements
        let thaiTickerText, englishTickerText;
        
        let tickerReasonThai = reasons[formData.reasonKey].thai;
        let tickerReasonEn = reasons[formData.reasonKey].english;
        if (formData.reasonKey === '18') {
             tickerReasonThai = carriageChangeMap[formData.carriageChangeType].thai;
             tickerReasonEn = `a ${carriageChangeMap[formData.carriageChangeType].english}`;
        } else if (formData.reasonKey === '19') {
             tickerReasonThai = `${formData.unavailableCarriageType} ไม่มีให้บริการ`;
             tickerReasonEn = `${unavailableCarriageMap[formData.unavailableCarriageType]} unavailable`;
        }
        
        if (formData.trainNumber && formData.origin && formData.destination) {
            const shortOrigin = formData.origin.substring(0, 10);
            const shortDest = formData.destination.substring(0, 10);
            const shortOriginEn = translate(formData.origin).substring(0, 15);
            const shortDestEn = translate(formData.destination).substring(0, 15);
            thaiTickerText = `ขบวนที่ ${formData.trainNumber} (${shortOrigin}-${shortDest}) ${tickerReasonThai} ${thaiParts.location || ''} ${formData.reasonKey !== '18' && formData.reasonKey !== '19' ? 'ทำให้ขบวนรถล่าช้า' : ''}. ขออภัยในความไม่สะดวก`;
            englishTickerText = `Train No. ${formData.trainNumber} (${shortOriginEn}-${shortDestEn}) ${formData.reasonKey !== '18' && formData.reasonKey !== '19' ? 'delayed due to' : 'has'} ${tickerReasonEn} ${englishParts.location || ''}. We apologize for the inconvenience.`;
        } else {
            thaiTickerText = `แจ้งเหตุการณ์: ${tickerReasonThai} ${thaiParts.location || ''} อาจส่งผลให้การเดินรถล่าช้า. ขออภัยในความไม่สะดวก`;
            englishTickerText = `Notice: Disruption due to ${tickerReasonEn} ${englishParts.location || ''}. Delays may occur. We apologize for the inconvenience.`;
        }
        
        // 5. Display results
        document.getElementById('thaiOutput').textContent = thaiText.replace(/\. \./g, '.').replace(/\s+/g, ' ');
        document.getElementById('englishOutput').textContent = englishText.replace(/\. \./g, '.').replace(/\s+/g, ' ');
        document.getElementById('thaiTickerOutput').textContent = thaiTickerText.replace(/\s+/g, ' ');
        document.getElementById('englishTickerOutput').textContent = englishTickerText.replace(/\s+/g, ' ');
        outputArea.classList.remove('hidden');
        outputArea.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });

    document.getElementById('clearFormBtn').addEventListener('click', () => {
        form.reset();
        outputArea.classList.add('hidden');
        updateConditionalFields();
        updateLocationFields();
        // Set date back to today after reset
        document.getElementById('unavailableDate').value = new Date().toISOString().split('T')[0];
        document.getElementById('locationType').value = 'not_specified';
    });
    
    // --- INITIALIZATION ---
    function initialize() {
        populateDatalist('trainNumbersList', Array.from({length: 1000}, (_, i) => i + 1));
        populateDatalist('stationList', Object.keys(stationTranslation));
        
        // Set default date for "unavailable carriage" to today
        document.getElementById('unavailableDate').value = new Date().toISOString().split('T')[0];

        reasonSelect.addEventListener('change', updateConditionalFields);
        locationTypeSelect.addEventListener('change', updateLocationFields);
        
        // Initial setup
        updateConditionalFields();
        updateLocationFields();
    }

    // Run on page load
    initialize();

</script>
</body>
</html>


